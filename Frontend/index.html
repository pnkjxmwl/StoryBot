<!DOCTYPE html>
<html>
<head>
  <title>Story Form</title>
  <style>
    .result {
      margin-top: 20px;
      padding: 10px;
      border: 1px solid #ccc;
    }
  </style>
</head>
<body>
  <h1>Story Form</h1>

  <form id="storyForm">
    <div>
      <label for="title">Title:</label>
      <input type="text" id="title" name="title" required>
    </div>

    <div>
      <label>Theme:</label>
      <div>
        <input type="radio" id="theme1" name="theme" value="thriller" checked>
        <label for="theme1">thriller</label>
      </div>
      <div>
        <input type="radio" id="theme2" name="theme" value="comedy">
        <label for="theme2">comedy</label>
      </div>
    </div>

    <div>
      <button type="submit">Submit</button>
    </div>
  </form>

  <div id="result" class="result">

    <div id="part1">

    </div>

    <div id="part2">

    </div>
    
    <div id="part3">

    </div>

  </div>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>

  <script>

    document.getElementById('storyForm').addEventListener('submit', function(event) {
      event.preventDefault();

      const title = document.getElementById('title').value;
      const theme = document.querySelector('input[name="theme"]:checked').value;
      const userId = '64aef2b16541d44d79defa7e'; // Replace with your user ID




      
      const requestBody = {
        content: title,
        theme: theme,
        userId: userId
      };
      console.log(title,theme,userId);
      axios.post('http://127.0.0.1:4000/api/v1/story', requestBody)
                .then((response) => {
                  console.log(response)
            //console.log(response.data.data,typeof response);
            //    const story = response.data.data.content;
            //   const imglink=response.data.data.img[0];
            //   let imgtag = document.createElement('img');
            //   imgtag.src = imglink;
            // const resultContainer = document.getElementById('result');
            // resultContainer.textContent = story;
            // resultContainer.appendChild(imgtag);
            const partsArray= response.data.data.content
            const imageArray= response.data.data.img
            for (let i = 0; i < partsArray.length; i++) {
                            let partNumber, partContent;
                  if (partsArray[i].includes(':')) {
                    const [partNum, ...contentArr] = partsArray[i].split(':');
                    partNumber = partNum.trim();
                    partContent = contentArr.join(':').trim();
                  } else {
                    partNumber = `Part ${i + 1}`;
                    partContent = partsArray[i].trim();
                  }

                  const h2Tag = document.createElement('h2');
                  h2Tag.textContent = partContent;

                  const imgTag = document.createElement('img');
                  // Assuming you have the image URL for each part, replace 'imageURL' with the actual image URL
                  imgTag.setAttribute('src', imageArray[i]);

                  const targetDiv = document.getElementById(`part${i + 1}`);
                  targetDiv.appendChild(h2Tag);
                  targetDiv.appendChild(imgTag);
      }

                }, (error) => {
                console.log(error);
                })
    });
  </script>
</body>
</html>
